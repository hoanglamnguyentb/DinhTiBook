{"ast":null,"code":"import { ref, watch } from 'vue';\nimport appConfig from \"../../../../app.config\";\nimport PageHeader from \"@/components/page-header\";\nimport Layout from \"../../../layouts/main.vue\";\nimport APIService from '../../../helpers/ApiService';\nimport DropZone from \"@/components/widgets/dropZone\";\nimport { toast } from 'vue3-toastify';\nimport 'vue3-toastify/dist/index.css';\nexport default {\n  page: {\n    title: \"Import tin tức\",\n    meta: [{\n      name: \"Import tin tức\",\n      content: appConfig.description\n    }]\n  },\n  setup() {\n    let configImport = ref({});\n    let files = ref([]);\n    let dropzoneFile = ref(\"\");\n    const drop = e => {\n      dropzoneFile.value = e.dataTransfer.files[0];\n      files.value[0] = dropzoneFile.value;\n    };\n    const selectedFile = e => {\n      dropzoneFile.value = document.querySelector(\".dropzoneFile\").files[0];\n      files.value[0] = e.target.files[0];\n    };\n    watch(() => [...files.value], currentValue => {\n      return currentValue;\n    });\n    return {\n      configImport,\n      drop,\n      selectedFile,\n      files\n    };\n  },\n  data() {\n    return {\n      title: \"Import tin tức\",\n      items: [{\n        text: \"Tin tức\",\n        href: \"/tin-tuc\"\n      }, {\n        text: \"Import tin tức\",\n        active: true\n      }]\n    };\n  },\n  beforeMount() {\n    APIService.get('/tinh/import').then(rs => {\n      this.configImport.value = rs.data.data.config;\n    }).catch(err => {\n      console.log(err);\n    });\n  },\n  methods: {\n    deleteRecord(ele) {\n      ele.target.parentElement.parentElement.parentElement.remove();\n    },\n    async OnSubmit() {\n      let formData = new FormData();\n      formData.append('fileImport', this.files[0]);\n      APIService.post('/TinTuc/importv1', formData).then(response => {\n        if (response.status == 200) {\n          this.files.shift();\n          toast.success(\"Import thành công\", {\n            \"theme\": \"colored\",\n            autoClose: 2000\n          });\n        } else {\n          toast.error(\"Lỗi xử lý\", {\n            \"theme\": \"colored\",\n            autoClose: 2000\n          });\n        }\n      }).catch(error => {\n        toast.success(\"Có lỗi\" + error, {\n          \"theme\": \"colored\",\n          autoClose: 2000\n        });\n      });\n    }\n  },\n  components: {\n    PageHeader,\n    Layout,\n    DropZone\n  }\n};","map":{"version":3,"names":["ref","watch","appConfig","PageHeader","Layout","APIService","DropZone","toast","page","title","meta","name","content","description","setup","configImport","files","dropzoneFile","drop","e","value","dataTransfer","selectedFile","document","querySelector","target","currentValue","data","items","text","href","active","beforeMount","get","then","rs","config","catch","err","console","log","methods","deleteRecord","ele","parentElement","remove","OnSubmit","formData","FormData","append","post","response","status","shift","success","autoClose","error","components"],"sources":["D:\\HINET_1\\BacKan\\client\\src\\views\\dashboard\\QL_TinTuc\\Import.vue"],"sourcesContent":["<script>\r\nimport { ref, watch } from 'vue';\r\nimport appConfig from \"../../../../app.config\"\r\nimport PageHeader from \"@/components/page-header\"\r\nimport Layout from \"../../../layouts/main.vue\";\r\nimport APIService from '../../../helpers/ApiService';\r\nimport DropZone from \"@/components/widgets/dropZone\";\r\nimport { toast } from 'vue3-toastify';\r\nimport 'vue3-toastify/dist/index.css';\r\n    export default {\r\n        page: {\r\n            title: \"Import tin tức\",\r\n            meta: [\r\n                {\r\n                    name: \"Import tin tức\",\r\n                    content: appConfig.description\r\n                }\r\n            ]\r\n        },\r\n        setup() {\r\n            let configImport = ref({})\r\n            let files = ref([]);\r\n            let dropzoneFile = ref(\"\");\r\n            const drop = (e) => {\r\n                dropzoneFile.value = e.dataTransfer.files[0];\r\n                files.value[0] = dropzoneFile.value;\r\n            };\r\n            const selectedFile = (e) => {\r\n                dropzoneFile.value = document.querySelector(\".dropzoneFile\").files[0];\r\n                files.value[0] = e.target.files[0];\r\n            };\r\n            watch(\r\n                () => [...files.value],\r\n                (currentValue) => {\r\n                    return currentValue;\r\n                }\r\n            );\r\n            return {\r\n                configImport,\r\n                drop,\r\n                selectedFile,\r\n                files\r\n            }\r\n        },\r\n        data() {\r\n            return {\r\n                title: \"Import tin tức\",\r\n                items: [{\r\n                    text: \"Tin tức\",\r\n                    href: \"/tin-tuc\",\r\n                },\r\n                {\r\n                    text: \"Import tin tức\",\r\n                    active: true,\r\n                },],\r\n            }\r\n        },\r\n        beforeMount() {\r\n            APIService.get('/tinh/import')\r\n            .then(rs => {\r\n                this.configImport.value = rs.data.data.config\r\n            })\r\n            .catch(err => {\r\n                console.log(err);\r\n            });\r\n        },\r\n        methods: {\r\n           \r\n            deleteRecord(ele) {\r\n                ele.target.parentElement.parentElement.parentElement.remove();\r\n            },\r\n            async OnSubmit() {\r\n                let formData = new FormData();\r\n                formData.append('fileImport', this.files[0]);\r\n                APIService.post('/TinTuc/importv1', formData)\r\n                    .then(response => {\r\n                        if(response.status == 200) {\r\n                            this.files.shift()\r\n\r\n                            toast.success(\"Import thành công\",{\r\n                                \"theme\": \"colored\",\r\n                                autoClose: 2000\r\n                            });\r\n                        } else {\r\n                            toast.error(\"Lỗi xử lý\",{\r\n                                \"theme\": \"colored\",\r\n                                autoClose: 2000\r\n                            });\r\n                        }\r\n                    })\r\n                    .catch(error => {\r\n                        toast.success(\"Có lỗi\" + error,{\r\n                                \"theme\": \"colored\",\r\n                                autoClose: 2000\r\n                        });\r\n                    });\r\n                \r\n            }\r\n        },\r\n        \r\n\r\n        components: {\r\n            PageHeader,\r\n            Layout,\r\n            DropZone,\r\n            \r\n        }\r\n    }\r\n</script>\r\n\r\n<template>\r\n   <Layout>\r\n    <PageHeader :title=\"title\" :items=\"items\" />\r\n    <form @submit.prevent=\"OnSubmit\" enctype=\"multipart/form-data\">\r\n        <!-- <div class=\"row mb-3\" v-for=\"(item, index) in configImport.value\" :key=\"index\">\r\n            <div class=\"col-lg-3\">\r\n                <label for=\"{{ item.nameprop }}\" class=\"form-label\">{{ item.displayname }}</label>\r\n            </div>\r\n            <div class=\"col-lg-9\">\r\n                <input type=\"text\" class=\"form-control\" :value=\"item.column\" id=\"nameInput\" placeholder=\"Chọn cột cấu hình\">\r\n            </div>\r\n        </div> -->\r\n\r\n        <!-- <div class=\"row mb-3\">\r\n            <div class=\"col-lg-3\">\r\n                <label for=\"startRow\" class=\"form-label\">Dòng bắt đầu</label>\r\n            </div>\r\n            <div class=\"col-lg-3\">\r\n                <input type=\"number\" class=\"form-control\" id=\"startRow\" placeholder=\"Nhập dòng bắt đầu\">\r\n            </div>\r\n        </div> -->\r\n        <b-card-body>\r\n              <div class=\"vstack gap-2\">\r\n                <DropZone @drop.prevent=\"drop\" @change=\"selectedFile\" />\r\n\r\n                <div class=\"border rounded\" v-for=\"(file, index) of files\" :key=\"index\">\r\n                  <div class=\"d-flex align-items-center p-2\">\r\n                    <div class=\"flex-grow-1\">\r\n                      <div class=\"pt-1\">\r\n                        <h5 class=\"fs-14 mb-1\" data-dz-name=\"\">\r\n                          {{ file.name }}\r\n                        </h5>\r\n                        <p class=\"fs-13 text-muted mb-0\" data-dz-size=\"\">\r\n                          <strong>{{ (file.size / 1024).toFixed() }}</strong> KB\r\n                        </p>\r\n                        <strong class=\"error text-danger\" data-dz-errormessage=\"\"></strong>\r\n                      </div>\r\n                    </div>\r\n                    <!-- <div class=\"flex-shrink-0 ms-3\">\r\n                      <b-button data-dz-remove=\"\" variant=\"danger\" size=\"sm\" @click=\"deleteRecord\">\r\n                        <i class=\"bx bx-trash\" />\r\n                      </b-button>\r\n                    </div> -->\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n            </b-card-body>\r\n            \r\n        <div class=\"text-end\">\r\n            <button type=\"submit\" class=\"btn btn-primary\">Import</button>\r\n        </div>\r\n    </form>\r\n  </Layout>\r\n</template>\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}