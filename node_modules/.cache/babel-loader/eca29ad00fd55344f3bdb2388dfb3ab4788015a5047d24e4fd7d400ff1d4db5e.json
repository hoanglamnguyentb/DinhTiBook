{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { required, helpers } from \"@vuelidate/validators\";\nimport appConfig from \"../../../../app.config\";\nimport useVuelidate from \"@vuelidate/core\";\nimport { authMethods, notificationMethods } from \"@/state/helpers\";\nimport APIService from '@/helpers/ApiService';\nimport router from '@/router/index';\nimport * as jose from 'jose';\nexport default {\n  setup() {\n    return {\n      v$: useVuelidate()\n    };\n  },\n  page: {\n    title: \"Đăng nhập\",\n    meta: [{\n      name: \"description\",\n      content: appConfig.description\n    }]\n  },\n  data() {\n    return {\n      username: \"\",\n      password: \"\",\n      submitted: false,\n      authError: null,\n      tryingToLogIn: false,\n      isAuthError: false,\n      authSuccess: null,\n      dismissSecs: 2,\n      dismissCountDown: 0,\n      tenHeThong: appConfig.title\n    };\n  },\n  validations: {\n    username: {\n      required: helpers.withMessage(\"Tài khoản không được để trống\", required)\n    },\n    password: {\n      required: helpers.withMessage(\"Mật khẩu không được để trống\", required)\n    }\n  },\n  computed: {},\n  methods: {\n    ...authMethods,\n    ...notificationMethods,\n    countDownChanged(dismissCountDown) {\n      this.dismissCountDown = dismissCountDown;\n    },\n    async submitLogin() {\n      this.submitted = true;\n      this.v$.$touch();\n      try {\n        let dataLogin = await APIService.post(\"user/login\", {\n          username: this.username,\n          password: this.password\n        });\n        if (dataLogin.data != null && dataLogin.data.accessToken) {\n          this.authError = null;\n          this.dismissCountDown = this.dismissSecs;\n          localStorage.setItem(\"user\", JSON.stringify(dataLogin.data.userData));\n          localStorage.setItem(\"accessToken\", dataLogin.data.accessToken);\n          console.log('1');\n          var token = dataLogin.data.accessToken;\n          console.log(\"2\", token);\n          const protectedHeader = jose.decodeJwt(token);\n          console.log(\"3\");\n          console.log(protectedHeader);\n          console.log(protectedHeader[\"http://schemas.microsoft.com/ws/2008/06/identity/claims/role\"]);\n          const Role = protectedHeader[\"http://schemas.microsoft.com/ws/2008/06/identity/claims/role\"];\n          APIService.post(\"SanPham/Create\", this.sanpham).then(response => {\n            console.log('rolecode', response);\n          });\n          setTimeout(() => {\n            var redirectUrl = this.$route.params.redirectFrom;\n            if (redirectUrl) {\n              router.push(redirectUrl);\n            } else {\n              router.push('/dashboard');\n            }\n          }, 2000);\n        }\n      } catch (e) {\n        this.submitted = false;\n        if (e.status == 401) {\n          this.authError = \"Đăng nhập thất bại. Tài khoản hoặc mật khẩu không đúng.\";\n        } else {\n          if (e.data && e.data.Message) {\n            this.authError = e.data.Message;\n          } else {\n            this.authError = \"Đăng nhập thất bại. Vui lòng thử lại sau.\";\n          }\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["required","helpers","appConfig","useVuelidate","authMethods","notificationMethods","APIService","router","jose","setup","v$","page","title","meta","name","content","description","data","username","password","submitted","authError","tryingToLogIn","isAuthError","authSuccess","dismissSecs","dismissCountDown","tenHeThong","validations","withMessage","computed","methods","countDownChanged","submitLogin","$touch","dataLogin","post","accessToken","localStorage","setItem","JSON","stringify","userData","console","log","token","protectedHeader","decodeJwt","Role","sanpham","then","response","setTimeout","redirectUrl","$route","params","redirectFrom","push","e","status","Message"],"sources":["D:\\DA\\DoAnFrontEnd\\DoAnClient\\client\\src\\views\\dashboard\\account\\login.vue"],"sourcesContent":["<script>\r\nimport {\r\n  required,\r\n  helpers\r\n} from \"@vuelidate/validators\";\r\nimport appConfig from \"../../../../app.config\";\r\nimport useVuelidate from \"@vuelidate/core\";\r\n\r\nimport {\r\n  authMethods,\r\n  notificationMethods,\r\n} from \"@/state/helpers\";\r\n\r\nimport APIService from '@/helpers/ApiService';\r\nimport router from '@/router/index'\r\n\r\nimport * as jose from 'jose'\r\n\r\nexport default {\r\n  setup() {\r\n    return {\r\n      v$: useVuelidate()\r\n    };\r\n  },\r\n  page: {\r\n    title: \"Đăng nhập\",\r\n    meta: [{\r\n      name: \"description\",\r\n      content: appConfig.description,\r\n    },],\r\n  },\r\n  data() {\r\n    return {\r\n      username: \"\",\r\n      password: \"\",\r\n      submitted: false,\r\n      authError: null,\r\n      tryingToLogIn: false,\r\n      isAuthError: false,\r\n      authSuccess : null,\r\n      dismissSecs: 2,\r\n      dismissCountDown: 0,\r\n      tenHeThong: appConfig.title\r\n    };\r\n  },\r\n  validations: {\r\n    username: {\r\n      required: helpers.withMessage(\"Tài khoản không được để trống\", required),\r\n    },\r\n    password: {\r\n      required: helpers.withMessage(\"Mật khẩu không được để trống\", required),\r\n    },\r\n  },\r\n  computed: {\r\n\r\n  },\r\n  methods: {\r\n    ...authMethods,\r\n    ...notificationMethods,\r\n    countDownChanged(dismissCountDown) {\r\n      this.dismissCountDown = dismissCountDown\r\n    },\r\n    async submitLogin() {\r\n      this.submitted = true;\r\n      this.v$.$touch();\r\n      try {\r\n        let dataLogin = await APIService.post(\"user/login\", {\r\n          username: this.username,\r\n          password: this.password,\r\n        })\r\n\r\n        if(dataLogin.data != null && dataLogin.data.accessToken){\r\n          this.authError = null;\r\n          this.dismissCountDown = this.dismissSecs\r\n          localStorage.setItem(\"user\", JSON.stringify(dataLogin.data.userData));\r\n          localStorage.setItem(\"accessToken\", dataLogin.data.accessToken);\r\n\r\n          console.log('1')\r\n          \r\n          var token = dataLogin.data.accessToken;\r\n          console.log(\"2\", token)\r\n          const protectedHeader = jose.decodeJwt(token)\r\n          console.log(\"3\")\r\n          console.log(protectedHeader)\r\n          console.log(protectedHeader[\"http://schemas.microsoft.com/ws/2008/06/identity/claims/role\"]);\r\n          const Role = protectedHeader[\"http://schemas.microsoft.com/ws/2008/06/identity/claims/role\"];\r\n          \r\n          APIService.post(\"SanPham/Create\", this.sanpham)\r\n          .then(response =>{\r\n            console.log('rolecode', response);\r\n          })\r\n          \r\n          \r\n            setTimeout(() => {\r\n            var redirectUrl = this.$route.params.redirectFrom\r\n            if(redirectUrl){\r\n              router.push(redirectUrl);\r\n            }else{\r\n              router.push('/dashboard');\r\n            }\r\n          }, 2000);\r\n          \r\n\r\n          \r\n        }\r\n      } catch (e) {\r\n        this.submitted = false;\r\n        if(e.status == 401){\r\n          this.authError = \"Đăng nhập thất bại. Tài khoản hoặc mật khẩu không đúng.\";\r\n        }else {\r\n          if(e.data && e.data.Message){\r\n            this.authError = e.data.Message;\r\n          }else{\r\n            this.authError = \"Đăng nhập thất bại. Vui lòng thử lại sau.\";\r\n          }\r\n          \r\n        }\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div class=\"auth-page-wrapper pt-5\">\r\n    <div class=\"auth-one-bg-position auth-one-bg\" id=\"auth-particles\">\r\n      <div class=\"bg-overlay\"></div>\r\n\r\n      <div class=\"shape\">\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0 0 1440 120\">\r\n          <path d=\"M 0,36 C 144,53.6 432,123.2 720,124 C 1008,124.8 1296,56.8 1440,40L1440 140L0 140z\"></path>\r\n        </svg>\r\n      </div>\r\n      <Particles id=\"tsparticles\" :options=\"{\r\n        particles: {\r\n          number: {\r\n            value: 90,\r\n            density: {\r\n              enable: true,\r\n              value_area: 800,\r\n            },\r\n          },\r\n          color: {\r\n            value: '#ffffff',\r\n          },\r\n          shape: {\r\n            type: 'circle',\r\n            stroke: {\r\n              width: 0,\r\n              color: '#000000',\r\n            },\r\n            polygon: {\r\n              nb_sides: 5,\r\n            },\r\n            image: {\r\n              src: 'img/github.svg',\r\n              width: 100,\r\n              height: 100,\r\n            },\r\n          },\r\n          opacity: {\r\n            value: 0.8,\r\n            random: true,\r\n            anim: {\r\n              enable: true,\r\n              speed: 1,\r\n              opacity_min: 0,\r\n              sync: false,\r\n            },\r\n          },\r\n          size: {\r\n            value: 4,\r\n            random: true,\r\n            anim: {\r\n              enable: false,\r\n              speed: 4,\r\n              size_min: 0.2,\r\n              sync: false,\r\n            },\r\n          },\r\n          line_linked: {\r\n            enable: false,\r\n            distance: 150,\r\n            color: '#ffffff',\r\n            opacity: 0.4,\r\n            width: 1,\r\n          },\r\n          move: {\r\n            enable: true,\r\n            speed: 2,\r\n            direction: 'none',\r\n            random: false,\r\n            straight: false,\r\n            out_mode: 'out',\r\n            attract: {\r\n              enable: false,\r\n              rotateX: 600,\r\n              rotateY: 1200,\r\n            },\r\n          },\r\n        },\r\n        interactivity: {\r\n          detect_on: 'canvas',\r\n          events: {\r\n            onhover: {\r\n              enable: true,\r\n              mode: 'bubble',\r\n            },\r\n            onclick: {\r\n              enable: true,\r\n              mode: 'repulse',\r\n            },\r\n            resize: true,\r\n          },\r\n          modes: {\r\n            grab: {\r\n              distance: 400,\r\n              line_linked: {\r\n                opacity: 1,\r\n              },\r\n            },\r\n            bubble: {\r\n              distance: 400,\r\n              size: 4,\r\n              duration: 2,\r\n              opacity: 0.8,\r\n              speed: 3,\r\n            },\r\n            repulse: {\r\n              distance: 200,\r\n            },\r\n            push: {\r\n              particles_nb: 4,\r\n            },\r\n            remove: {\r\n              particles_nb: 2,\r\n            },\r\n          },\r\n        },\r\n        retina_detect: true,\r\n        config_demo: {\r\n          hide_card: false,\r\n          background_color: '#b61924',\r\n          background_image: '',\r\n          background_position: '50% 50%',\r\n          background_repeat: 'no-repeat',\r\n          background_size: 'cover',\r\n        },\r\n      }\" />\r\n    </div>\r\n\r\n    <div class=\"auth-page-content\">\r\n      <b-container>\r\n        <b-row>\r\n          <b-col lg=\"12\">\r\n            <div class=\"text-center mt-sm-5 mb-4 text-white-50\">\r\n              <div>\r\n                <router-link to=\"/\" class=\"d-inline-block auth-logo\">\r\n                  <img src=\"@/assets/images/logo_dinhti.png\" alt=\"\" height=\"70\" />\r\n                </router-link>\r\n              </div>\r\n              <!-- <p class=\"mt-3 fs-15 fw-medium\">\r\n                {{ tenHeThong }}\r\n              </p> -->\r\n            </div>\r\n          </b-col>\r\n        </b-row>\r\n\r\n        <b-row class=\"justify-content-center\">\r\n          <b-col md=\"8\" lg=\"6\" xl=\"5\">\r\n            <b-card no-body class=\"mt-4\">\r\n              <b-card-body class=\"p-4\">\r\n                <div class=\"text-center mt-2\">\r\n                  <h5 class=\"text-primary\">Đăng nhập</h5>\r\n                </div>\r\n                <div class=\"p-2 mt-4\">\r\n                  <b-alert \r\n                  v-model=\"dismissCountDown\"\r\n                  @dismissed=\"dismissCountDown=0\"\r\n                  @dismiss-count-down=\"countDownChanged\" \r\n                  dismissible\r\n                  variant=\"success\" \r\n                  class=\"mt-3\">\r\n                    Đăng nhập thành công. Trình duyệt tự động chuyển hướng sau <b color=\"red\">{{ dismissCountDown }}</b> giây.\r\n                  </b-alert>\r\n                  <b-alert v-model=\"authError\" variant=\"danger\" class=\"mt-3\" dismissible>{{ authError }}</b-alert>\r\n                  <div>\r\n                  </div>\r\n                  <form @submit.prevent=\"submitLogin\">\r\n                    <div class=\"mb-3\">\r\n                      <label for=\"username\" class=\"form-label\">Tài khoản</label>\r\n                      <input type=\"text\" class=\"form-control\" id=\"username\" placeholder=\"Nhập tài khoản\" v-model=\"username\" />\r\n                      <div class=\"invalid-feedback\">\r\n                        <span></span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div class=\"mb-3\">\r\n                      <div class=\"float-end\">\r\n                        <router-link to=\"/forgot-password\" class=\"text-muted\">Quên mật khẩu?</router-link>\r\n                      </div>\r\n                      <label class=\"form-label\" for=\"password-input\">Mật khẩu</label>\r\n                      <div class=\"position-relative auth-pass-inputgroup mb-3\">\r\n                        <input type=\"password\" v-model=\"password\" class=\"form-control pe-5\" placeholder=\"Nhập mật khẩu\" id=\"password-input\" />\r\n                        <b-button variant=\"link\" class=\"position-absolute end-0 top-0 text-decoration-none text-muted\"\r\n                          type=\"button\" id=\"password-addon\">\r\n                          <i class=\"ri-eye-fill align-middle\"></i>\r\n                        </b-button>\r\n                        <div class=\"invalid-feedback\">\r\n                          <span></span>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <div class=\"form-check\">\r\n                      <input class=\"form-check-input\" type=\"checkbox\" value=\"\" id=\"auth-remember-check\" />\r\n                      <label class=\"form-check-label\" for=\"auth-remember-check\">Ghi nhớ đăng nhập</label>\r\n                    </div>\r\n\r\n                    <div class=\"mt-4\">\r\n                      <b-button variant=\"success\" class=\"w-100\" type=\"submit\" :disable=\"submitted\">\r\n                        <span v-if=\"submitted\"><b-spinner small></b-spinner>\r\n                          Đang xử lý...\r\n                        </span>\r\n                        <span v-if=\"!submitted\">Đăng nhập</span>\r\n                      </b-button>\r\n                    </div>\r\n                  </form>\r\n                </div>\r\n              </b-card-body>\r\n            </b-card>\r\n          </b-col>\r\n        </b-row>\r\n      </b-container>\r\n    </div>\r\n\r\n    <footer class=\"footer\">\r\n      <b-container>\r\n        <b-row>\r\n          <b-col lg=\"12\">\r\n            <div class=\"text-center\">\r\n              <p class=\"mb-0 text-muted\">\r\n                &copy; {{ new Date().getFullYear() }} {{ tenHeThong }}\r\n              </p>\r\n            </div>\r\n          </b-col>\r\n        </b-row>\r\n      </b-container>\r\n    </footer>\r\n  </div>\r\n</template>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}